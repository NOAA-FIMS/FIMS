# Instructions ----
#' This file follows the format generated by FIMS:::use_testthat_template().
#' Necessary tests include input and output (IO) correctness [IO
#' correctness], edge-case handling [Edge handling], and built-in errors and
#' warnings [Error handling]. See `?FIMS:::use_testthat_template` for more
#' information. Every test should have a @description tag that takes up just
#' one line, which will be used in the bookdown report of {testthat} results.

# Setup ----
# Load or prepare any necessary data for testing

# rcpp-fleet ----
## IO correctness ----
test_that("rcpp fleet works with correct inputs", {
  #' @description Test that two selectivity modules can be set up without any
  #' errors and they have the appropriate ids.
  # Create selectivity for fleet 1
  selectivity_fleet1 <- methods::new(LogisticSelectivity)
  expect_equal((selectivity_fleet1$get_id()), 1)

  # Create selectivity for fleet 2
  selectivity_fleet2 <- methods::new(LogisticSelectivity)
  expect_equal((selectivity_fleet2$get_id()), 2)

  #' @description Test that rcpp fleet interface works with logistic
  #' selectivity and no output, errors, messages, or warnings are produced
  #' when setting the SelectivityIDs for the fleets.
  # Add selectivity to fleet
  fleet1 <- methods::new(Fleet)
  fleet2 <- methods::new(Fleet)
  expect_silent(fleet1$SetSelectivityID(selectivity_fleet1$get_id()))
  expect_silent(fleet2$SetSelectivityID(selectivity_fleet2$get_id()))

  #' @description Test that setting and getting the age-composition ID works
  #' within the fleet module.
  expect_silent(fleet1$SetObservedAgeCompDataID(1))
  expect_equal(fleet1$GetObservedAgeCompDataID(), 1)

  #' @description Test that setting and getting the index ID works within the
  #' fleet module.
  expect_silent(fleet1$SetObservedIndexDataID(1))
  expect_equal(fleet1$GetObservedIndexDataID(), 1)

  clear()
})

## Edge handling ----
# No edge cases to test for this interface.


## Error handling ----
test_that("rcpp fleet returns correct error messages", {
  #' @description Test that the rcpp fleet interface returns an error when
  #' given a string rather than an integer.
  fleet1 <- methods::new(Fleet)
  expect_error(fleet1$SetSelectivityID("id"))
  expect_error(fleet1$SetObservedAgeCompDataID("id"))
  expect_error(fleet1$SetObservedLengthCompDataID("id"))
  expect_error(fleet1$SetObservedIndexDataID("id"))
  clear()
})
