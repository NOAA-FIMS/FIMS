# Instructions ----
#' This file follows the format generated by FIMS:::use_testthat_template().
#' Necessary tests include input and output (IO) correctness [IO
#' correctness], edge-case handling [Edge handling], and built-in errors and
#' warnings [Error handling]. See `?FIMS:::use_testthat_template` for more
#' information. Every test should have a @description tag that takes up just
#' one line, which will be used in the bookdown report of {testthat} results.

# is_fims_verbose ----
## Setup ----
# Load or prepare any necessary data for testing
option_verbosity <- getOption("rlib_message_verbosity")
on.exit(options("rlib_message_verbosity" = option_verbosity), add = TRUE)

## IO correctness ----
test_that("is_fims_verbose() works with correct inputs", {
  #' @description Test that is_fims_verbose() returns a boolean.
  expect_type(object = is_fims_verbose(), "logical")

  #' @description Test that is_fims_verbose() returns TRUE by default.
  expect_true(is_fims_verbose())

  options("rlib_message_verbosity" = "quiet")
  #' @description Test that you can turn it to FALSE by setting the global
  #' verbosity option using `setOption()`.
  expect_false(is_fims_verbose())
})

## Edge handling ----
test_that("is_fims_verbose() returns correct outputs for edge cases", {
  #' @description Test that "verbose" works for setting the verbosity.
  expect_true({
    options("rlib_message_verbosity" = "verbose")
    is_fims_verbose()
  })
})

## Error handling ----
test_that("is_fims_verbose() returns correct error messages", {
  #' @description Test that is_fims_verbose("x") returns error because the
  #' function does not take any arguments.
  expect_error(
    object = is_fims_verbose("x"),
    regexp = "unused argument."
  )
})
