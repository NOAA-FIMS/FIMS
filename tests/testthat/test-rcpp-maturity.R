# Instructions ----
#' This file follows the format generated by FIMS:::use_testthat_template().
#' Necessary tests include input and output (IO) correctness [IO
#' correctness], edge-case handling [Edge handling], and built-in errors and
#' warnings [Error handling]. See `?FIMS:::use_testthat_template` for more
#' information. Every test should have a @description tag, which can span
#' multiple lines, that will be used in the bookdown report of the results from
#' {testthat}.

# rcpp maturity ----
## Setup ----
# Load or prepare any necessary data for testing

## IO correctness ----
test_that("rcpp maturity works with correct inputs", {
  # Create maturity1
  maturity1 <- methods::new(LogisticMaturity)
  
  maturity1$inflection_point[1]$value <- 10.0
  maturity1$inflection_point[1]$min <- 8.0
  maturity1$inflection_point[1]$max <- 12.0
  maturity1$inflection_point[1]$estimation_type$set("fixed_effects")
  maturity1$slope[1]$value <- 0.2

  #' @description Test that `get_id()` from the maturity module returns the correct id.
  expect_equal(maturity1$get_id(), 1)
  #' @description Test that the value of `inflection_point` can be set and get correctly.
  expect_equal(maturity1$inflection_point[1]$value, 10.0)
  #' @description Test that the min of `inflection_point` can be set and get correctly.
  expect_equal(maturity1$inflection_point[1]$min, 8.0)
  #' @description Test that the max of `inflection_point` can be set and get correctly.
  expect_equal(maturity1$inflection_point[1]$max, 12.0)
  #' @description Test that the `estimation_type` of `inflection_point` can be set and get correctly.
  expect_equal(maturity1$inflection_point[1]$estimation_type$get(), "fixed_effects")
  #' @description Test that the value of `slope` can be set and get correctly.
  expect_equal(maturity1$slope[1]$value, 0.2)
  #' @description Test that the `evaluate()` method from the maturity module works correctly.
  expect_equal(maturity1$evaluate(10.0), 0.5)

  # Create maturity2
  maturity2 <- methods::new(LogisticMaturity)
  #' @description Test that rcpp maturity returns the correct id.
  expect_equal((maturity2$get_id()), 2)

  clear()
})

## Edge handling ----
# No edge cases to test for this interface.

## Error handling ----
# No error handling to test for this interface.
